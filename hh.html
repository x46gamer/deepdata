<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Forensic Data</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .info-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 15px;
            flex-shrink: 0;
        }
        .success { background-color: #28a745; }
        .error { background-color: #dc3545; }
        .label {
            font-weight: bold;
            min-width: 250px;
        }
        .value {
            word-break: break-all;
            flex-grow: 1;
        }
        .clipboard-box {
            padding: 10px;
            border: 1px solid #ccc;
            margin-top: 5px;
            white-space: pre-wrap;
        }
        button {
            margin: 5px;
            padding: 5px 10px;
            cursor: pointer;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background: #0056b3;
        }
    </style><!-- Add this style -->
<style>
.keystroke-log {
    border: 1px solid #ccc;
    padding: 10px;
    margin-top: 10px;
    max-height: 100px;
    overflow-y: auto;
    font-family: monospace;
    white-space: pre-wrap;
}
</style>

<!-- Add this check to your existing checks object -->

</head>
<body>
    <div class="container">
        <h1>Browser Environment Sniffer</h1>
        <div id="data-container"></div>
    </div>

    <script>
        const dataContainer = document.getElementById('data-container');
        const adTest = document.createElement('div');
        adTest.className = 'ad-unit';
        document.body.appendChild(adTest);

        const checks = {
            // Existing checks
            async 'User Agent'() {
                return navigator.userAgent;
            },
            async 'Platform'() {
                return navigator.platform;
            },
            async 'Screen Resolution'() {
                return `${window.screen.width}x${window.screen.height} (${window.devicePixelRatio}x DPR)`;
            },
            async 'Color Depth'() {
                return `${window.screen.colorDepth} bit`;
            },
            async 'Browser Language'() {
                return navigator.language;
            },
            async 'Cookies Enabled'() {
                return navigator.cookieEnabled ? 'Yes' : 'No';
            },
            async 'Do Not Track'() {
                return navigator.doNotTrack || 'Not specified';
            },
            async 'Online Status'() {
                return navigator.onLine ? 'Online' : 'Offline';
            },
            async 'Dark Mode'() {
                return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'Enabled' : 'Disabled';
            },
            async 'Browser Privacy Mode'() {
                try {
                    const storage = window.sessionStorage;
                    storage.setItem('test', 'test');
                    storage.removeItem('test');
                    return 'Normal mode';
                } catch {
                    return 'Private/Incognito mode';
                }
            },
            async 'CPU Cores'() {
                return navigator.hardwareConcurrency || 'Unknown';
            },
            async 'Device Memory'() {
                return navigator.deviceMemory ? `${navigator.deviceMemory} GB` : 'Not available';
            },
            async 'Touch Support'() {
                return 'ontouchstart' in window ? 'Supported' : 'Not supported';
            },
            async 'Battery Status'() {
                try {
                    const battery = await navigator.getBattery();
                    return `${Math.floor(battery.level * 100)}% (${battery.charging ? 'âš¡ Charging' : 'ðŸ”‹ Discharging'})`;
                } catch {
                    return null;
                }
            },
            async 'Geolocation Support'() {
                return 'geolocation' in navigator ? 'Supported' : 'Not supported';
            },
            async 'IP Address'() {
                try {
                    const response = await fetch('https://api.ipify.org?format=json');
                    const data = await response.json();
                    return data.ip;
                } catch {
                    return null;
                }
            },
            async 'Country'() {
                try {
                    const response = await fetch('https://ipapi.co/country_name/');
                    return await response.text();
                } catch {
                    return null;
                }
            },
            async 'Timezone'() {
                return Intl.DateTimeFormat().resolvedOptions().timeZone;
            },
            async 'Current Time'() {
                return new Date().toLocaleString();
            },
            async 'Local Storage'() {
                return typeof localStorage !== 'undefined' ? 'Available' : 'Unavailable';
            },
            async 'WebGL'() {
                try {
                    const canvas = document.createElement('canvas');
                    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    if(gl) {
                        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                        return {
                            vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
                            renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
                        };
                    }
                    return null;
                } catch {
                    return null;
                }
            },
            async 'AdBlock Detection'() {
                return new Promise(resolve => {
                    setTimeout(() => {
                        const adHidden = adTest.offsetHeight === 0;
                        resolve(adHidden ? 'Detected' : 'Not detected');
                    }, 100);
                });
            },
            async 'PDF Viewer'() {
                return navigator.pdfViewerEnabled ? 'Enabled' : 'Disabled';
            },
            async 'Clipboard Access'() {
                return navigator.clipboard ? 'Supported' : 'Not supported';
            },
            async 'Clipboard Content'() {
                try {
                    if (!navigator.clipboard?.readText) {
                        throw new Error('Clipboard API not supported');
                    }

                    const container = document.createElement('div');
                    const btn = document.createElement('button');
                    btn.textContent = 'Click to Show Clipboard Content';
                    const content = document.createElement('div');
                    
                    btn.onclick = async () => {
                        try {
                            const text = await navigator.clipboard.readText();
                            content.textContent = text || 'Clipboard is empty';
                            content.className = 'clipboard-box';
                            btn.remove();
                        } catch (error) {
                            content.textContent = `Error: ${error.message}`;
                            content.className = 'clipboard-box error';
                        }
                    };

                    container.appendChild(btn);
                    container.appendChild(content);
                    return container;
                } catch (error) {
                    throw error;
                }
            },
            async 'Notification Permission'() {
                return Notification.permission;
            },
            async 'Motion Sensors'() {
                return {
                    accelerometer: 'Accelerometer' in window,
                    gyroscope: 'Gyroscope' in window
                };
            },
            async 'Network Information'() {
                return navigator.connection ? {
                    type: navigator.connection.effectiveType,
                    downlink: navigator.connection.downlink + ' Mbps',
                    rtt: navigator.connection.rtt + ' ms'
                } : null;
            },
            async 'Media Devices'() {
                try {
                    const devices = await navigator.mediaDevices.enumerateDevices();
                    return devices.filter(d => d.kind === 'videoinput' || d.kind === 'audioinput');
                } catch {
                    return null;
                }
            },
            async 'Social Media Logins'() {
                return new Promise(resolve => {
                    setTimeout(() => {
                        const logins = [];
                        if(document.cookie.includes('fbssls_')) logins.push('Facebook');
                        if(document.cookie.includes('SID') || document.cookie.includes('SSID')) logins.push('Google');
                        resolve(logins.length ? logins.join(', ') : 'None detected');
                    }, 100);
                });
            },
            async 'Printer Detection'() {
                return window.matchMedia('print').matches ? 'Available' : 'Unavailable';
            },
            async 'Screen Orientation'() {
                return `${screen.orientation.type} (${screen.orientation.angle}Â°)`;
            },
            async 'Installed Fonts'() {
                try {
                    const fonts = await window.queryLocalFonts();
                    return fonts.length ? [...new Set(fonts.map(f => f.family))] : null;
                } catch {
                    return null;
                }
            }
        };

        async function createInfoItem(name, check) {
            const item = document.createElement('div');
            item.className = 'info-item';
            
            const status = document.createElement('div');
            status.className = 'status';
            
            const label = document.createElement('div');
            label.className = 'label';
            label.textContent = name;
            
            const value = document.createElement('div');
            value.className = 'value';
            
            item.appendChild(status);
            item.appendChild(label);
            item.appendChild(value);
            dataContainer.appendChild(item);

            try {
                const result = await check();
                if (result !== null && result !== undefined) {
                    status.classList.add('success');
                    if (result instanceof HTMLElement) {
                        value.appendChild(result);
                    } else if (typeof result === 'object') {
                        value.textContent = JSON.stringify(result, null, 2);
                    } else {
                        value.textContent = result;
                    }
                } else {
                    status.classList.add('error');
                    value.textContent = 'Information not available';
                }
            } catch (error) {
                status.classList.add('error');
                value.textContent = `Error: ${error.message}`;
            }
        }

        async function runChecks() {
            for (const [name, check] of Object.entries(checks)) {
                await createInfoItem(name, check);
            }
        }

        runChecks();
    </script><script>
const checks = {
    // ... keep all your existing checks ...

    async 'Keystroke Monitor'() {
        const container = document.createElement('div');
        const log = document.createElement('div');
        log.className = 'keystroke-log';
        log.textContent = 'Start typing...';
        
        let buffer = '';
        
        const clearBtn = document.createElement('button');
        clearBtn.textContent = 'Clear';
        clearBtn.onclick = () => {
            buffer = '';
            log.textContent = 'Log cleared';
        };

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Backspace') {
                buffer = buffer.slice(0, -1);
            } else if (e.key.length === 1) {
                buffer += e.key;
            }
            log.textContent = buffer || 'Start typing...';
            log.scrollTop = log.scrollHeight;
        });

        container.appendChild(log);
        container.appendChild(clearBtn);
        return container;
    }
};
</script>
</body>
</html>